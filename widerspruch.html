<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Widerspruch Kostenerstattungsverfahren ‚Äì PDF erstellen</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        /* 1. Grundlegende Stile & Farbvariablen */
        :root {
            --primary-color: #0070f3;
            --primary-hover: #005bb5;
            --secondary-color: #e9ecef;
            --secondary-hover: #d4dae0;
            --background-color: #f4f7f6;
            --text-color: #333;
            --light-text-color: #555;
            --white-color: #ffffff;
            --border-color: #ccc;
            --border-radius-main: 12px;
            --border-radius-small: 6px;
            --shadow: 0 8px 30px rgba(0, 0, 0, 0.1);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--background-color);
            color: var(--text-color);
            margin: 0;
            padding: 0;
            line-height: 1.6;
        }

        /* 2. Container und Layout */
        .site-header {
            background-color: var(--white-color);
            padding: 1rem 2rem;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.07);
            text-align: center;
        }

        .site-logo {
            color: #1a5276;
            font-size: 1.5rem;
            font-weight: bold;
            text-decoration: none;
            transition: color 0.2s;
        }
        
        .site-logo:hover {
            color: #d35400;
        }

        .main-container {
            max-width: 750px;
            margin: 2rem auto; /* Abstand oben/unten und zentriert */
            padding: 1rem;
        }

        .intro-text, .hinweis-box-container {
            margin-bottom: 2rem;
            text-align: center;
        }
        
        h1 {
            font-size: 2rem;
            color: #1a5276;
            margin-bottom: 0.5rem;
        }

        .hinweis-box {
            padding: 1rem;
            margin-top: 1rem;
            border-left: 4px solid;
            border-radius: var(--border-radius-small);
            text-align: left;
        }
        
        .hinweis-box.info {
            background-color: #e6f7ff;
            border-color: #91d5ff;
        }

        .hinweis-box.warnung {
            background-color: #fffbe6;
            border-color: #ffe58f;
        }

        /* 3. Formular-Stile */
        form {
            padding: 2.5rem;
            background: var(--white-color);
            border-radius: var(--border-radius-main);
            box-shadow: var(--shadow);
        }

        label {
            font-weight: 600;
            display: block;
            margin-bottom: 0.5rem;
            color: var(--light-text-color);
        }

        input[type="text"],
        input[type="date"],
        textarea {
            width: 100%;
            padding: 0.9rem;
            margin-bottom: 1.5rem;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-small);
            box-sizing: border-box; /* Wichtig f√ºr konsistente Gr√∂√üen */
            transition: border-color 0.3s, box-shadow 0.3s;
        }

        input[type="text"]:focus,
        input[type="date"]:focus,
        textarea:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(0, 112, 243, 0.2);
        }

        textarea {
            min-height: 120px;
            resize: vertical;
        }

        button, .button-style {
            display: inline-block;
            width: 100%;
            padding: 0.9rem 1.8rem;
            background: var(--primary-color);
            color: var(--white-color);
            border: none;
            border-radius: var(--border-radius-small);
            font-weight: bold;
            font-size: 1rem;
            cursor: pointer;
            text-align: center;
            transition: background-color 0.3s, transform 0.2s;
        }

        button:hover, .button-style:hover {
            background: var(--primary-hover);
            transform: translateY(-2px);
        }

        /* 4. Pop-up Fenster */
        #spendenPopup {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.6);
            align-items: center;
            justify-content: center;
        }

        .popup-content {
            background: var(--white-color);
            padding: 2rem;
            border-radius: var(--border-radius-main);
            max-width: 400px;
            width: 90%;
            text-align: center;
            box-shadow: 0 0 20px rgba(0,0,0,0.2);
        }
        
        .popup-content h2 {
            margin-top: 0;
        }
        
        .paypal-button {
            background:#ffc439;
            border:none;
            padding:0.8rem 1.6rem;
            font-weight:bold;
            border-radius:var(--border-radius-small);
            cursor: pointer;
            width: 100%;
            margin-top: 1rem;
            box-sizing: border-box;
        }
        
        .close-popup-btn {
            margin-top: 1rem;
            background: none;
            border: none;
            color: var(--primary-color);
            font-weight: bold;
            cursor: pointer;
        }
        
        /* 5. Footer */
        footer {
            text-align: center;
            padding: 2rem 1rem;
            margin-top: 2rem;
            color: var(--light-text-color);
            font-size: 0.9rem;
        }

        footer a {
            color: var(--primary-color);
            text-decoration: none;
        }
        
        footer a:hover {
            text-decoration: underline;
        }

    </style>
</head>
<body>

    <header class="site-header">
        <a href="index.html" class="site-logo">Kassen-Lotse</a>
    </header>

    <div class="main-container">
    
        <div class="intro-text">
            <h1>Widerspruch im Kostenerstattungsverfahren</h1>
            <p>Wenn dein Antrag abgelehnt wurde, kannst du Widerspruch einlegen. F√ºlle dazu das folgende Formular aus ‚Äì dein PDF wird automatisch erstellt:</p>
        </div>

        <div class="hinweis-box-container">
            <div class="hinweis-box warnung">
                <strong>Hinweis:</strong> Unsere Inhalte und Formulare ersetzen keine Rechtsberatung. Sie dienen der allgemeinen Unterst√ºtzung.
            </div>
            <div class="hinweis-box info">
                <strong>Technischer Hinweis:</strong> F√ºr einen erfolgreichen Download, nutze bitte einen Browser wie Chrome oder Firefox, nicht die Google-App.
            </div>
        </div>
        
        <form id="widerspruchForm">
            <label for="name">Dein vollst√§ndiger Name</label>
            <input type="text" id="name" required>

            <label for="adresse">Deine Adresse</label>
            <textarea id="adresse" required></textarea>

            <label for="kasse">Name & Adresse der Krankenkasse</label>
            <textarea id="kasse" required></textarea>

            <label for="versichertennr">Versichertennummer</label>
            <input type="text" id="versichertennr" required>

            <label for="bescheiddatum">Datum des Ablehnungsbescheids</label>
            <input type="date" id="bescheiddatum" required>

            <button type="submit">üìÑ PDF Widerspruch erstellen</button>
        </form>

    </div>

    <div id="spendenPopup">
        <div class="popup-content">
            <h2>Danke f√ºr deine Nutzung üíõ</h2>
            <p>Wenn dir dieses Tool geholfen hat, unterst√ºtze es mit einer kleinen Spende:</p>
            <form action="https://www.paypal.com/donate" method="post" target="_blank">
                <input type="hidden" name="business" value="info@kassen-lotse.de" />
                <input type="hidden" name="item_name" value="Spende f√ºr das Projekt Kostenerstattungsverfahren Psychotherapie." />
                <input type="hidden" name="currency_code" value="EUR" />
                <input type="submit" value="Spenden mit PayPal" class="paypal-button" />
            </form>
            <button onclick="closePopup()" class="close-popup-btn">Nein danke, schlie√üen</button>
        </div>
    </div>
    
    <footer>
        <p>&copy; 2025 Kassen-Lotse | <a href="impressum.html">Impressum</a> | <a href="https://kassen-lotse.de/datenschutz.html" target="_blank">Datenschutz</a></p>
    </footer>

    <script>
    document.getElementById("widerspruchForm").addEventListener("submit", function(e) {
        e.preventDefault();

        const { jsPDF } = window.jspdf;
        const doc = new jsPDF({
            unit: "mm",
            format: "a4"
        });

        // Formulardaten abrufen
        const name = document.getElementById("name").value;
        const adresse = document.getElementById("adresse").value;
        const kasse = document.getElementById("kasse").value;
        const versichertennr = document.getElementById("versichertennr").value;
        const bescheiddatumInput = document.getElementById("bescheiddatum").value;
        
        // Daten formatieren
        const absender = `${name}\n${adresse}`;
        const empfaenger = `An:\n${kasse}`;
        const heutigesDatum = new Date().toLocaleDateString("de-DE");
        const bescheiddatum = new Date(bescheiddatumInput).toLocaleDateString("de-DE");

        // --- PDF-Erstellung ---

        doc.setFont('Helvetica');
        doc.setFontSize(12);

        // 1. Absender (klein √ºber dem Empf√§nger)
        doc.setFontSize(10);
        doc.text(absender, 20, 20);

        // 2. Datum (oben rechts)
        doc.setFontSize(12);
        doc.text(heutigesDatum, 190, 35, { align: 'right' });

        // 3. Empf√§nger (mit etwas Abstand)
        doc.text(empfaenger, 20, 50);

        // 4. Betreffzeile
        doc.setFont(undefined, 'bold'); // Schriftart fett
        doc.text(`Widerspruch gegen Ihren Bescheid vom ${bescheiddatum}`, 20, 85);
        doc.setFont(undefined, 'normal'); // Schriftart wieder normal
        doc.text(`Versichertennummer: ${versichertennr}`, 20, 92);
        
        // 5. Haupttext (wird automatisch umgebrochen)
        const haupttext = `
Sehr geehrte Damen und Herren,

hiermit lege ich fristgerecht Widerspruch gegen Ihren Ablehnungsbescheid vom ${bescheiddatum} ein, in dem Sie meinen Antrag auf Kostenerstattung einer ambulanten psychotherapeutischen Behandlung abgelehnt haben.

Die Ablehnung ist aus meiner Sicht weder medizinisch noch rechtlich haltbar. Ich habe durch dokumentierte Kontaktversuche bei kassenzugelassenen Therapeut:innen nachgewiesen, dass ich trotz intensiver Bem√ºhungen keinen Therapieplatz innerhalb einer zumutbaren Wartezeit finden konnte. Eine Behandlung bei einer approbierten, aber nicht kassenzugelassenen Therapeutin stellt daher keine Wahlleistung dar, sondern ist medizinisch dringend geboten.

Gem√§√ü ¬ß 13 Abs. 3 SGB V besteht in einem solchen Fall ein "Rechtsanspruch" auf Kostenerstattung. Die aktuelle Versorgungslage in der psychotherapeutischen Regelversorgung ist bundesweit als angespannt bekannt ‚Äì dies kann jedoch nicht zulasten der Versicherten gehen. Auch das Bundessozialgericht (BSG) hat mehrfach betont, dass Kassen im Rahmen ihrer F√ºrsorgepflicht verpflichtet sind, in medizinisch notwendigen F√§llen die Kosten zu √ºbernehmen, wenn die Regelversorgung versagt (vgl. u.a. BSG, Urteil vom 21.05.1997 ‚Äì 1 RK 28/95).

Ich fordere Sie daher auf, meinen Antrag erneut zu pr√ºfen und mir die Kosten√ºbernahme zu bewilligen. Sollte ich innerhalb der gesetzlich vorgesehenen Frist keine positive R√ºckmeldung erhalten, behalte ich mir rechtliche Schritte ausdr√ºcklich vor.

Mit freundlichen Gr√º√üen
`;
        
        // Haupttext mit kontrolliertem Zeilenumbruch einf√ºgen
        const textLines = doc.splitTextToSize(haupttext, 170); // 170mm Breite f√ºr den Textblock
        doc.text(textLines, 20, 110);
        
        // 6. Name am Ende (Position h√§ngt von der L√§nge des Haupttextes ab)
        // Wir berechnen die Position basierend auf der Anzahl der Zeilen im Haupttext
        const textEndeY = 110 + (textLines.length * 7); // 7mm pro Zeile (Standard-Zeilenh√∂he bei 12pt)
        doc.text(name, 20, textEndeY + 10); // +10mm Abstand nach der Gru√üformel

        // PDF speichern
        doc.save("widerspruch_kostenerstattung.pdf");

        // Spenden-Popup anzeigen
        document.getElementById("spendenPopup").style.display = "flex";
    });

    function closePopup() {
        document.getElementById("spendenPopup").style.display = "none";
    }
</script>

</body>
</html>
